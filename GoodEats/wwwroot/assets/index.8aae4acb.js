import{r as C,c as y,a as p,o as u,b as v,d as a,e as b,F as O,f as K,g as Y,h as G,i as F,S as I,j as J,t as _,k as Q,w as S,p as x,l as $,m as w,n as M,q as L,s as X,u as j,v as N,x as Z,y as ee,M as te,z as oe}from"./vendor.cc0aef4c.js";const ae=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}};ae();const c=C({user:{},account:{},activeRestaurant:{},restaurants:[],reviews:[],activeProfile:{},profileReviews:[]});var f=(t,e)=>{for(const[o,s]of e)t[o]=s;return t};const se={name:"App",setup(){return{appState:y(()=>c)}}};function ne(t,e,o,s,n,r){const i=p("Navbar"),m=p("router-view"),d=p("RestaurantModal");return u(),v(O,null,[a("header",null,[b(i)]),a("main",null,[b(m),b(d)])],64)}var re=f(se,[["render",ne]]);const D=window.location.origin.includes("localhost"),q=D?"https://localhost:5001":"",ie="dev-jifdsfgm.us.auth0.com",ce="kdA2drx86aMYWundbilyJsAPj43nWovV",le="https://MarkDev.com",de="modulepreload",V={},ue="/",R=function(e,o){return!o||o.length===0?e():Promise.all(o.map(s=>{if(s=`${ue}${s}`,s in V)return;V[s]=!0;const n=s.endsWith(".css"),r=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${r}`))return;const i=document.createElement("link");if(i.rel=n?"stylesheet":de,n||(i.as="script",i.crossOrigin=""),i.href=s,document.head.appendChild(i),n)return new Promise((m,d)=>{i.addEventListener("load",m),i.addEventListener("error",d)})})).then(()=>e())};function _e(t){switch(t){case"./pages/AboutPage.vue":return R(()=>import("./AboutPage.ca60ffc2.js"),["assets/AboutPage.ca60ffc2.js","assets/vendor.cc0aef4c.js"]);case"./pages/AccountPage.vue":return R(()=>import("./AccountPage.fd3116cd.js"),["assets/AccountPage.fd3116cd.js","assets/AccountPage.68e73645.css","assets/vendor.cc0aef4c.js"]);case"./pages/HomePage.vue":return R(()=>import("./HomePage.65dcd374.js"),["assets/HomePage.65dcd374.js","assets/vendor.cc0aef4c.js"]);case"./pages/ProfilePage.vue":return R(()=>import("./ProfilePage.8b28dec2.js"),["assets/ProfilePage.8b28dec2.js","assets/ProfilePage.267bdc97.css","assets/vendor.cc0aef4c.js"]);default:return new Promise(function(e,o){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(o.bind(null,new Error("Unknown variable dynamic import: "+t)))})}}function T(t){return()=>_e(`./pages/${t}.vue`)}const me=[{path:"/",name:"Home",component:T("HomePage")},{path:"/about",name:"About",component:T("AboutPage")},{path:"/profiles/:id",name:"Profile",component:T("ProfilePage")},{path:"/account",name:"Account",component:T("AccountPage"),beforeEnter:G}],B=K({linkActiveClass:"router-link-active",linkExactActiveClass:"router-link-exact-active",history:Y(),routes:me});function A(t,e){if(D)console[t](`[${t}] :: ${new Date().toLocaleTimeString()} :: `,...e);else{switch(t){case"log":case"assert":return}console[t](`[${t}] :: ${new Date().toLocaleTimeString()} :: `,...e)}}const g={log(){A("log",arguments)},error(){A("error",arguments)},warn(){A("warn",arguments)},assert(){A("assert",arguments)},trace(){A("trace",arguments)}},h=F.create({baseURL:q,timeout:8e3});class ve{async getAccount(){try{const e=await h.get("/account");c.account=e.data}catch(e){g.error("HAVE YOU STARTED YOUR SERVER YET???",e)}}}const ge=new ve;class k{static async confirm(e="Are you sure?",o="You won't be able to revert this!",s="warning",n="Yes, delete it!"){try{return!!(await I.fire({title:e,text:o,icon:s,showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:n})).isConfirmed}catch{return!1}}static toast(e="Warning!",o="warning",s="top-end",n=3e3,r=!0){I.fire({title:e,icon:o,position:s,timer:n,timerProgressBar:r,toast:!0,showConfirmButton:!1})}static error(e){var o;if(e.isAxiosError){const{response:s}=e;this.toast(((o=s.data.error)==null?void 0:o.message)||s.data.message,"error")}else this.toast(e.message||e,"error")}static success(e="Success!"){this.toast(e,"success")}}const pe={connection:"connection",connected:"connected",disconnect:"disconnect",authenticate:"authenticate",authenticated:"authenticated",userConnected:"userConnected",userDisconnected:"userDisconnected",error:"error"};class he{constructor(e=!1,o=q){}on(e,o){var s;return(s=this.socket)==null||s.on(e,o.bind(this)),this}onConnected(e){g.log("[SOCKET_CONNECTION]",e),this.connected=!0,this.playback()}onAuthenticated(e){g.log("[SOCKET_AUTHENTICATED]",e),this.authenticated=!0,this.playback()}authenticate(e){var o;(o=this.socket)==null||o.emit(pe.authenticate,e)}onError(e){g.error("[SOCKET_ERROR]",e)}enqueue(e,o){g.log("[ENQUEING_ACTION]",{action:e,payload:o}),this.queue.push({action:e,payload:o})}playback(){g.log("[SOCKET_PLAYBACK]");const e=[...this.queue];this.queue=[],e.forEach(o=>{this.emit(o.action,o.payload)})}emit(e,o=void 0){if(this.requiresAuth&&!this.authenticated)return this.enqueue(e,o);if(!this.connected)return this.enqueue(e,o);this.socket.emit(e,o)}}class fe extends he{constructor(){super();this.on("error",this.onError)}onError(e){k.toast(e.message,"error")}}const H=new fe,l=J({domain:ie,clientId:ce,audience:le,useRefreshTokens:!0,onRedirectCallback:t=>{B.push(t&&t.targetUrl?t.targetUrl:window.location.pathname)}});l.on(l.AUTH_EVENTS.AUTHENTICATED,async function(){h.defaults.headers.authorization=l.bearer,h.interceptors.request.use(be),c.user=l.user,await ge.getAccount(),H.authenticate(l.bearer)});async function be(t){if(!l.isAuthenticated)return t;const e=l.identity.exp*1e3,o=e<Date.now(),s=e<Date.now()+1e3*60*60*12;return o?await l.loginWithPopup():s&&(await l.getTokenSilently(),h.defaults.headers.authorization=l.bearer,H.authenticate(l.bearer)),t}const we={setup(){return{user:y(()=>c.user),account:y(()=>c.account),async login(){l.loginWithPopup()},async logout(){l.logout({returnTo:window.location.origin})}}}},U=t=>(x("data-v-5fd4eb40"),t=t(),$(),t),ye={class:"navbar-text"},xe={key:1,class:"dropdown my-2 my-lg-0"},$e={class:"dropdown-toggle selectable","data-bs-toggle":"dropdown","aria-expanded":"false",id:"authDropdown"},Ae={key:0},Se=["src"],Re={class:"mx-3 text-success lighten-30"},Te={class:"dropdown-menu p-0 list-group w-100","aria-labelledby":"authDropdown"},ke=U(()=>a("div",{class:"list-group-item list-group-item-action hoverable"}," Manage Account ",-1)),Ee=U(()=>a("i",{class:"mdi mdi-logout"},null,-1)),Pe=w(" logout "),Ce=[Ee,Pe];function Oe(t,e,o,s,n,r){const i=p("router-link");return u(),v("span",ye,[s.user.isAuthenticated?(u(),v("div",xe,[a("div",$e,[s.account.picture?(u(),v("div",Ae,[a("img",{src:s.account.picture,alt:"account photo",height:"40",class:"rounded"},null,8,Se),a("span",Re,_(s.account.name),1)])):Q("",!0)]),a("div",Te,[b(i,{to:{name:"Account"}},{default:S(()=>[ke]),_:1}),a("div",{class:"list-group-item list-group-item-action hoverable text-danger",onClick:e[1]||(e[1]=(...m)=>s.logout&&s.logout(...m))},Ce)])])):(u(),v("button",{key:0,class:"btn selectable text-success lighten-30 text-uppercase my-2 my-lg-0",onClick:e[0]||(e[0]=(...m)=>s.login&&s.login(...m))}," Login "))])}var Ie=f(we,[["render",Oe],["__scopeId","data-v-5fd4eb40"]]),Me=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ie});const Le={},je={class:"modal fade",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"},Ne={class:"modal-dialog modal-xl modal-dialog-centered",role:"document"},De={class:"modal-content"},qe={class:"modal-header"},Ve={class:"modal-title",id:"exampleModalLongTitle"},Be=a("a",{class:"close","data-dismiss":"modal","aria-label":"Close"},[a("span",{"aria-hidden":"true"},[a("i",{class:"mdi mdi-close"})])],-1),He={class:"modal-body"};function Ue(t,e){return u(),v("div",je,[a("div",Ne,[a("div",De,[a("div",qe,[a("h5",Ve,[M(t.$slots,"modal-title")]),Be]),a("div",He,[M(t.$slots,"modal-body")])])])])}var ze=f(Le,[["render",Ue]]),We=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:ze});const Ke={setup(){return{}}},E=t=>(x("data-v-5834392f"),t=t(),$(),t),Ye={class:"navbar navbar-expand-lg navbar-dark bg-dark px-3"},Ge=E(()=>a("div",{class:"d-flex flex-column align-items-center"},[a("h3",null,"Good Eats")],-1)),Fe=E(()=>a("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[a("span",{class:"navbar-toggler-icon"})],-1)),Je={class:"collapse navbar-collapse",id:"navbarText"},Qe=E(()=>a("ul",{class:"navbar-nav me-auto"},[a("li")],-1));function Xe(t,e,o,s,n,r){const i=p("router-link"),m=p("Login");return u(),v("nav",Ye,[b(i,{class:"navbar-brand d-flex",to:{name:"Home"}},{default:S(()=>[Ge]),_:1}),Fe,a("div",Je,[Qe,b(m)])])}var Ze=f(Ke,[["render",Xe],["__scopeId","data-v-5834392f"]]),et=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ze});class tt{async getAll(){const e=await h.get("api/restaurants");c.restaurants=e.data}async setActive(e){c.activeRestaurant=e;const o=await h.get(`api/restaurants/${e.id}/reviews`);c.reviews=o.data}}const ot=new tt;const at={props:{restaurant:{type:Object,required:!0}},setup(t){return{async setActive(){try{ot.setActive(t.restaurant)}catch(e){k.toast("Something went wrong","error"),g.error(e)}}}}},st=t=>(x("data-v-ae54053c"),t=t(),$(),t),nt={class:"d-flex"},rt=["src","alt"],it={class:"ms-4 d-flex flex-column justify-content-center"},ct={class:"pb-2 border-bottom border-secondary"},lt={class:""},dt={class:"m-3 justify-self-end"},ut={class:"text-uppercase"},_t=st(()=>a("i",{class:"mdi mdi-star text-warning"},null,-1));function mt(t,e,o,s,n,r){return u(),v("div",{"data-bs-target":"#restaurant-modal","data-bs-toggle":"modal",class:"m-4 elevation-2 d-flex justify-content-between selectable",onClick:e[0]||(e[0]=(...i)=>s.setActive&&s.setActive(...i))},[a("div",nt,[a("img",{class:"img-fluid",src:o.restaurant.picture,alt:o.restaurant.name+" picture"},null,8,rt),a("div",it,[a("h3",ct,[w(_(o.restaurant.name)+" ",1),a("small",null,[a("kbd",lt,_(o.restaurant.category),1)])]),a("p",null,_(o.restaurant.location),1)])]),a("div",dt,[a("h5",ut,[w("Rating: "+_(o.restaurant.averageRating),1),_t,w(" ("+_(o.restaurant.totalReviews)+")",1)])])])}var vt=f(at,[["render",mt],["__scopeId","data-v-ae54053c"]]),gt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:vt});class pt{async getReviewsByProfileId(e){const o=await h.get(`api/profiles/${e}/reviews`);c.profileReviews=[...o.data,...o.data.reverse(),...o.data,...o.data.reverse()]}async createReview(e){const o=await h.post("api/reviews",e);g.log(o.data),c.reviews.push(o.data)}}const ht=new pt;const ft={setup(){const t=C({});return{review:t,restaurant:y(()=>c.activeRestaurant),reviews:y(()=>c.reviews),async createReview(){try{await ht.createReview({body:t.body,rating:t.rating,restaurantId:c.activeRestaurant.id})}catch(e){k.toast("Call the MIB","error"),g.log(e)}}}}},P=t=>(x("data-v-80445b5e"),t=t(),$(),t),bt={class:"container"},wt={class:"row"},yt={class:"col-md-6"},xt=["src","alt"],$t={class:"col-md-6"},At={class:"ms-4 d-flex flex-column justify-content-center"},St={class:"pb-2 border-bottom border-secondary"},Rt={class:""},Tt={class:"mt-4"},kt={class:"d-flex justify-content-between"},Et=P(()=>a("label",{for:"body"},[a("small",null,"Write a review")],-1)),Pt={class:"d-flex flex-column"},Ct=P(()=>a("label",{for:"rating"},[a("small",null,"rating")],-1)),Ot=P(()=>a("button",{class:"btn btn-success"},"Submit",-1)),It={class:"mt-4 reviews scrollable-y"};function Mt(t,e,o,s,n,r){const i=p("Review"),m=p("Modal");return u(),L(m,{id:"restaurant-modal"},{"modal-title":S(()=>[w(_(s.restaurant.name),1)]),"modal-body":S(()=>[a("div",bt,[a("div",wt,[a("div",yt,[a("img",{class:"img-fluid",src:s.restaurant.picture,alt:s.restaurant.name+" picture"},null,8,xt)]),a("div",$t,[a("div",At,[a("h3",St,[w(_(s.restaurant.name)+" ",1),a("small",null,[a("kbd",Rt,_(s.restaurant.category),1)])]),a("p",null,_(s.restaurant.location),1)]),a("div",Tt,[a("form",{onSubmit:e[2]||(e[2]=X((...d)=>s.createReview&&s.createReview(...d),["prevent"])),class:"text-end"},[a("div",kt,[Et,a("div",Pt,[Ct,j(a("input",{type:"number",min:"1",max:"5",required:"","onUpdate:modelValue":e[0]||(e[0]=d=>s.review.rating=d)},null,512),[[N,s.review.rating]])])]),j(a("textarea",{class:"w-100",name:"body",id:"body",rows:"5","onUpdate:modelValue":e[1]||(e[1]=d=>s.review.body=d)},null,512),[[N,s.review.body]]),Ot],32)]),a("div",It,[(u(!0),v(O,null,Z(s.reviews,d=>(u(),L(i,{key:d.id,review:d},null,8,["review"]))),128))])])])])]),_:1})}var Lt=f(ft,[["render",Mt],["__scopeId","data-v-80445b5e"]]),jt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Lt});const Nt={props:{review:{type:Object,required:!0}},setup(t){const e=ee();return{goToProfile(){te.getOrCreateInstance(document.getElementById("restaurant-modal")).hide(),e.push({name:"Profile",params:{id:t.review.creator.id}})}}}},z=t=>(x("data-v-65c62f5c"),t=t(),$(),t),Dt={class:"m-3 p-3 bg-secondary lighten-20"},qt=z(()=>a("span",{class:"f-28"},'"',-1)),Vt=z(()=>a("span",{class:"f-28"},'"',-1));function Bt(t,e,o,s,n,r){return u(),v("div",Dt,[a("h4",null,[qt,a("em",null,_(o.review.body),1),Vt]),a("a",{class:"text-end action",onClick:e[0]||(e[0]=(...i)=>s.goToProfile&&s.goToProfile(...i))}," - "+_(o.review.creator.name),1)])}var Ht=f(Nt,[["render",Bt],["__scopeId","data-v-65c62f5c"]]),Ut=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:Ht});function zt(t){Object.entries({"./components/Login.vue":Me,"./components/Modal.vue":We,"./components/Navbar.vue":et,"./components/Restaurant.vue":gt,"./components/RestaurantModal.vue":jt,"./components/Review.vue":Ut}).forEach(([o,s])=>{const n=s.name||o.substr(o.lastIndexOf("/")+1).replace(/\.\w+$/,"");t.component(n,s.default)})}const W=oe(re);zt(W);W.use(B).mount("#app");export{c as A,k as P,f as _,h as a,ht as b,g as l,ot as r};
